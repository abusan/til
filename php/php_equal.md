# 「==」での比較

PHPを使いだしてから6年くらい経って知ってるんだけど実際に遭遇すると衝撃だよねというただそれだけの話。

## "PHP" == 0 // true
```php
var_dump('PHP' == 0);
// bool(true)
```

いやわかってた。わかってたんだよ。フレームワークで値チェックもしてるし本番環境で想定されるデータではこれは起こらない。
手元で動かしたテストコードで5分くらいが無駄になっただけで良かった。いや良くない。

## からくり
「==」の比較演算子は両辺の値をキャストする。その際に文字列と数値を比較しているとだいPHPは文字列を可能な限り数値に変換しようと試みる。
上の例では数値の0は文字列にキャストされる。
```php
var_dump((string)0);
// string(1) "0"
```

じゃあ文字列の'PHP'はどうなるのか。
```php
var_dump((int)'PHP');
// int(0)
```

そしてPHP内部では「お、int(0)とint(0)だからtrueだね！」と判断してしまうわけだ。

## 救世主「===」
「===」は「==」から1文字増えただけなのにすごいことができる。なんと両辺の型も考慮してくれるんだ。
```php
var_dump('PHP' === 0);
// bool(false)
```

1文字増えただけで幸せになれると思ったらまあ落とし穴もあるわけでして。
型が厳密に判定されるということは、何かの手違いで数値が数値の文字列になっていたらfalseになってしまう。
```php
var_dump('0' === 0);
// bool(false)
```

PHPは型が無い、PHPは型を考えなくていいとよく言われるけど、実際はいろいろと型について考えさせられる言語だと思う。
